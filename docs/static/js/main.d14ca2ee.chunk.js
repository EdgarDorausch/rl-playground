(this["webpackJsonprl-playground"]=this["webpackJsonprl-playground"]||[]).push([[0],{74:function(t,e,n){t.exports=n(82)},79:function(t,e,n){},80:function(t,e,n){},82:function(t,e,n){"use strict";n.r(e);var i=n(0),r=n.n(i),a=n(49),o=n.n(a),s=(n(79),n(1)),l=n(2),c=n(7),u=n(5),h=n(8),d=(n(80),n(50)),v=n(6),f=function(){function t(e,n,i){Object(s.a)(this,t),this.algorithm=i,this.startCell=void 0,this.state=void 0,this.maze=void 0,this.mazeDim=void 0,this.startCell=e,this.state=e,this.maze=n,this.mazeDim=[n[0].length,n.length],this.algorithm.init(this.maze,this)}return Object(l.a)(t,[{key:"takeAction",value:function(t){var e=this.state.getNeighbor(t);null===e&&(e=this.state),this.algorithm.updateParams(e),this.state=e}},{key:"doStep",value:function(){var t=this.algorithm.chooseAction();this.takeAction(t)}},{key:"resetPosition",value:function(){this.state=this.startCell}}]),t}();function g(t,e){return"translate(".concat(t,",").concat(e,")")}function p(t){return t?"visible":"hidden"}function m(t){return new Promise((function(e){return setTimeout(e,t)}))}function w(t,e){return Math.sqrt(t*t+e*e)}function y(t){var e=t.length;return t[Math.floor(Math.random()*e)]}var b=["north","east","west","south"],k=n(51),E=function(){function t(e,n,i){Object(s.a)(this,t),this.discountFactor=e,this.learningRate=n,this.explorationFactor=i,this.maze=null,this.agent=null}return Object(l.a)(t,[{key:"init",value:function(t,e){this.maze=t,this.agent=e}},{key:"chooseGreedyAction",value:function(){var t=this;if(null===this.agent)throw new Error;if(null===this.maze)throw new Error;var e=b.map((function(e){if(null===t.agent)throw new Error;var n=t.agent.state.getNeighbor(e);return{action:e,value:null!==n?n.value:Number.NEGATIVE_INFINITY}})),n=Math.max.apply(Math,Object(k.a)(e.map((function(t){return t.value}))));if(n===Number.NEGATIVE_INFINITY)throw console.log(e),new Error("Cant choose greedy action! Deadlock!");return y(e.filter((function(t){return t.value===n}))).action}},{key:"chooseRandomAction",value:function(){return y(b)}},{key:"chooseAction",value:function(){return Math.random()<this.explorationFactor?this.chooseRandomAction():this.chooseGreedyAction()}},{key:"updateParams",value:function(t){if(null===this.agent)throw new Error;if(null===this.maze)throw new Error;var e=(1-this.learningRate)*this.agent.state.value+this.learningRate*(t.reward+this.discountFactor*t.value);this.agent.state.value=e}},{key:"startNewEpisode",value:function(){}},{key:"endEpisode",value:function(){}}]),t}(),z=v.b(v.a).domain([0,1]),O=function(){function t(e,n){Object(s.a)(this,t),this.maze=void 0,this.x=void 0,this.y=void 0,this.mazeDim=void 0,this.x=e[0],this.y=e[1],this.maze=n,this.mazeDim=[n[0].length,n.length]}return Object(l.a)(t,[{key:"checkPosition",value:function(t,e){return 0<=t&&t<this.mazeDim[0]&&0<=e&&e<this.mazeDim[1]}},{key:"getNeighbor",value:function(t){var e,n=this.x,i=this.y;switch(t){case"north":e=[n,i-1];break;case"east":e=[1+n,i];break;case"south":e=[n,i+1];break;case"west":e=[n-1,i];break;default:throw new Error("Unknown direction: ".concat(t))}var r=e,a=Object(d.a)(r,2),o=a[0],s=a[1];if(!this.checkPosition(o,s))return null;var l=this.maze[o][s];return l instanceof C?null:l}}]),t}(),S=function(t){function e(t,n,i){var r;return Object(s.a)(this,e),(r=Object(c.a)(this,Object(u.a)(e).call(this,n,i))).reward=void 0,r.x=void 0,r.y=void 0,r.value=void 0,r.policy=void 0,r.q=void 0,r.x=n[0],r.y=n[1],r.reward=t,r.value=0,r.policy=y(b),r.q={north:0,south:0,west:0,east:0},r}return Object(h.a)(e,t),Object(l.a)(e,[{key:"getColor",value:function(t){switch(t){case"reward":return z(this.reward);case"value":return z(this.value);case"simple":case"policy":case"q-function":return"darkgray"}}},{key:"getTriangleColor",value:function(t,e){switch(t){case"policy":return e===this.policy?"#222":"#eee";case"q-function":return z(this.q[e]);case"reward":case"simple":case"value":return"red"}}},{key:"showTriangles",value:function(t){switch(t){case"policy":case"q-function":return!0;case"reward":case"simple":case"value":return!1}}}]),e}(O),C=function(t){function e(){return Object(s.a)(this,e),Object(c.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(h.a)(e,t),Object(l.a)(e,[{key:"getColor",value:function(){return"#444"}},{key:"getTriangleColor",value:function(){return"#444"}},{key:"showTriangles",value:function(){return!1}}]),e}(O);var T=n(18),j=n.n(T),M=function(){function t(e,n,i,r,a){Object(s.a)(this,t),this.agent=e,this.maze=n,this.cellDim=i,this.cellSize=r,this.cellPadding=a,this.cellStriding=void 0,this.svgSize=void 0,this.svg=null,this.doTimeTravel=!1,this.viewMode="value",this.doStartNewEpisode=!1,this.stepCounter=0,this.stepCounterDOMElem=null,this.cellStriding=r+a,this.svgSize=i*this.cellStriding+a}return Object(l.a)(t,[{key:"setup",value:function(){this.svg=v.c(".App").append("svg").attr("width",this.svgSize).attr("height",this.svgSize).style("background-color","gray"),this.stepCounterDOMElem=document.getElementById("stepCounter")}},{key:"draw",value:function(){var t=this;if(null===this.svg)throw new Error("Svg is null! Is setup called before draw?");if(null===this.stepCounterDOMElem)throw new Error("stepCounter DOM Element is null! Is setup called before draw?");this.stepCounterDOMElem.innerHTML=this.stepCounter.toString(),this.svg.selectAll("*").remove();var e=this.svg.selectAll("g").data(this.maze).enter().append("g").attr("width",10);e.attr("transform",(function(e,n){return g(t.cellStriding*n+t.cellPadding,t.cellPadding)}));var n=e.selectAll("g").data((function(t){return t})).enter().append("g").attr("transform",(function(e,n){return g(0,t.cellStriding*n)}));n.append("rect").attr("width",this.cellSize).attr("height",this.cellSize).attr("fill",(function(e){return e.getColor(t.viewMode)})),e.selectAll("polygon").data((function(t){return t})).enter(),n.append("polygon").attr("points",(function(e){return n=t.cellSize,"0,0         ".concat(n/2,",").concat(n/2," 0,").concat(n);var n})).attr("fill",(function(e){return e.getTriangleColor(t.viewMode,"west")})).attr("visibility",(function(e){return p(e.showTriangles(t.viewMode))})),n.append("polygon").attr("points",(function(e){return n=t.cellSize,"0,0         ".concat(n/2,",").concat(n/2," ").concat(n,",0");var n})).attr("fill",(function(e){return e.getTriangleColor(t.viewMode,"north")})).attr("visibility",(function(e){return p(e.showTriangles(t.viewMode))})),n.append("polygon").attr("points",(function(e){return n=t.cellSize,"".concat(n,",").concat(n," ").concat(n/2,",").concat(n/2," ").concat(n,",0");var n})).attr("fill",(function(e){return e.getTriangleColor(t.viewMode,"east")})).attr("visibility",(function(e){return p(e.showTriangles(t.viewMode))})),n.append("polygon").attr("points",(function(e){return n=t.cellSize,"".concat(n,",").concat(n," ").concat(n/2,",").concat(n/2," 0,").concat(n);var n})).attr("fill",(function(e){return e.getTriangleColor(t.viewMode,"south")})).attr("visibility",(function(e){return p(e.showTriangles(t.viewMode))})),this.svg.append("circle").attr("r",this.cellSize/2.2).attr("cx",this.cellPadding+this.agent.state.x*this.cellStriding+this.cellSize/2).attr("cy",this.cellPadding+this.agent.state.y*this.cellStriding+this.cellSize/2).attr("fill","green")}},{key:"update",value:function(){if(this.stepCounter++,this.doStartNewEpisode&&(this.doStartNewEpisode=!1,this.agent.resetPosition()),this.doTimeTravel){this.doTimeTravel=!1;for(var t=0;t<1e4;t++)this.stepCounter++,this.agent.doStep()}this.agent.doStep()}},{key:"start",value:function(){return j.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:this.setup();case 1:return this.update(),t.next=5,j.a.awrap(m(30));case 5:this.draw(),t.next=1;break;case 8:case"end":return t.stop()}}),null,this)}}]),t}(),A=function(t){function e(){var t;Object(s.a)(this,e),(t=Object(c.a)(this,Object(u.a)(e).call(this,{}))).renderHandler=void 0;var n=function(t){for(var e=[0,0],n=[0,0],i=0;i<16;i++)for(var r=0;r<16;r++){var a=t[r].charAt(i);"\u20ac"===a&&(n=[i,r]),"$"===a&&(e=[i,r])}for(var o=new Array(16).fill(null).map((function(t,e){return new Array(16).fill(42)})),s=function(e,i){return"#"===t[i].charAt(e)?new C([e,i],o):new S(1-w(e-n[0],i-n[1])/w(16,16),[e,i],o)},l=0;l<16;l++)for(var c=0;c<16;c++)o[l][c]=s(l,c);var u=new f(o[e[0]][e[1]],o,new E(.25,.5,.6));return{maze:o,agent:u}}(["....#..........\u20ac","....##..########","........#.......","##  #########...","............#..#","....#......##..#","#####......#....",".......#####....",".......#......#.","...#.........##.","###########.....","...#............","...###...#######",".....#..........",".....#######....","$..............."]),i=n.maze,r=n.agent;return t.renderHandler=new M(r,i,16,30,2),console.log(i),console.log(r),t}return Object(h.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t=this;return r.a.createElement("div",{className:"App"},r.a.createElement("h1",null,"RL Playground"),r.a.createElement("select",{onChange:function(e){t.renderHandler.viewMode=e.target.options[e.target.selectedIndex].text}},r.a.createElement("option",null,"value"),r.a.createElement("option",null,"reward"),r.a.createElement("option",null,"simple"),r.a.createElement("option",null,"policy"),r.a.createElement("option",null,"q-function")),r.a.createElement("button",{type:"button",onClick:function(){return t.renderHandler.doTimeTravel=!0}},"time travel"),r.a.createElement("button",{type:"button",onClick:function(){return t.renderHandler.doStartNewEpisode=!0}},"reset"),r.a.createElement("p",{id:"stepCounter"},"756"))}},{key:"componentDidMount",value:function(){this.renderHandler.start().then()}}]),e}(r.a.PureComponent);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(A,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}},[[74,1,2]]]);
//# sourceMappingURL=main.d14ca2ee.chunk.js.map